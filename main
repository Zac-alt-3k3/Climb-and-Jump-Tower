local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Kiá»ƒm tra script Ä‘Ã£ cháº¡y chÆ°a
if _G.CombatSystemRunning then
    warn("Há»‡ thá»‘ng Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t trÆ°á»›c Ä‘Ã³")
    return
end
_G.CombatSystemRunning = true

-- Biáº¿n há»‡ thá»‘ng
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

-- CÃ i Ä‘áº·t máº·c Ä‘á»‹nh
local currentWalkSpeed = 100
local currentMode = 2
local fixnon = 0
local lastHeightCheck = 0

-- Táº¡o UI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SpeedControlUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game:GetService("CoreGui")


local nextCheckInterval = math.random(3, 4) -- Khá»Ÿi táº¡o ngáº«u nhiÃªn láº§n Ä‘áº§u

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 250, 0, 275)  -- Giáº£m chiá»u rá»™ng
Frame.Position = UDim2.new(0, 10, 0.5, -100)  -- SÃ¡t trÃ¡i (X = 10), giá»¯a chiá»u cao
Frame.AnchorPoint = Vector2.new(0, 0.5)  -- Neo trÃ¡i vÃ  giá»¯a dá»c
Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Frame.BackgroundTransparency = 0.3  -- Trong suá»‘t nháº¹
Frame.Parent = ScreenGui

-- Label WalkSpeed
local WalkSpeedLabel = Instance.new("TextLabel")
WalkSpeedLabel.Text = "WalkSpeed:"
WalkSpeedLabel.Size = UDim2.new(0.8, 0, 0, 30)
WalkSpeedLabel.Position = UDim2.new(0.1, 0, 0.1, 0)
WalkSpeedLabel.TextColor3 = Color3.new(1, 1, 1)
WalkSpeedLabel.Parent = Frame

-- TextBox WalkSpeed
local WalkSpeedBox = Instance.new("TextBox")
WalkSpeedBox.Text = "500"
WalkSpeedBox.Size = UDim2.new(0.8, 0, 0, 30)
WalkSpeedBox.Position = UDim2.new(0.1, 0, 0.2, 0)
WalkSpeedBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
WalkSpeedBox.TextColor3 = Color3.new(1, 1, 1)
WalkSpeedBox.Parent = Frame

-- Label Sá»‘ láº§n láº·p
local HatchEgg = Instance.new("TextLabel")
HatchEgg.Text = "Hatch egg"
HatchEgg.Size = UDim2.new(0.8, 0, 0, 30)
HatchEgg.Position = UDim2.new(0.1, 0, 0.4, 0)
HatchEgg.TextColor3 = Color3.new(1, 1, 1)
HatchEgg.Parent = Frame

-- TextBox Sá»‘ láº§n láº·p
local EggBox = Instance.new("TextBox")
EggBox.Text = "0"
EggBox.Size = UDim2.new(0.8, 0, 0, 30)
EggBox.Position = UDim2.new(0.1, 0, 0.5, 0)
EggBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
EggBox.TextColor3 = Color3.new(1, 1, 1)
EggBox.Parent = Frame

-- NÃºt Ãp dá»¥ng
local ApplyButton = Instance.new("TextButton")
ApplyButton.Text = "Speed & Hatch"
ApplyButton.Size = UDim2.new(0.8, 0, 0, 30)
ApplyButton.Position = UDim2.new(0.1, 0, 0.7, 0)
ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
ApplyButton.TextColor3 = Color3.new(1, 1, 1)
ApplyButton.Parent = Frame

-- ThÃªm nÃºt Reset NhÃ¢n Váº­t
local ResetButton = Instance.new("TextButton")
ResetButton.Text = "Auto farm"
ResetButton.Size = UDim2.new(0.8, 0, 0, 30)
ResetButton.Position = UDim2.new(0.1, 0, 0.8, 0) -- Äáº·t dÆ°á»›i nÃºt Ãp dá»¥ng 12%
ResetButton.BackgroundColor3 = Color3.fromRGB(215, 60, 0) -- MÃ u Ä‘á» cam
ResetButton.TextColor3 = Color3.new(1, 1, 1)
ResetButton.Font = Enum.Font.SourceSansBold
ResetButton.Parent = Frame

local currentMode = 2
local HatchEgg = 0

-- HÃ m cáº­p nháº­t giao diá»‡n
local function updateModeDisplay()
    if currentMode == 1 then
        ResetButton.Text = "Cháº¿ Ä‘á»™: Dá»«ng"
        ResetButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    elseif currentMode == 2 then
        ResetButton.Text = "Cháº¿ Ä‘á»™: BÃ¬nh thÆ°á»ng"
        ResetButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
    end
end

-- HÃ m kill nhÃ¢n váº­t
local function killCharacter()
    local character = player.Character
    if not character then return end
    
    local explosion = Instance.new("Explosion")
    explosion.Position = character:GetPivot().Position
    explosion.BlastRadius = 10
    explosion.BlastPressure = 0
    explosion.Parent = workspace
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid:ChangeState(Enum.HumanoidStateType.Dead)
    end
    
    local args = {"isAutoOn", 1}
    ReplicatedStorage:WaitForChild("ServerMsg"):WaitForChild("Setting"):InvokeServer(unpack(args))
    wait(3)
end

-- Káº¿t ná»‘i sá»± kiá»‡n nÃºt Ãp dá»¥ng
ApplyButton.MouseButton1Click:Connect(function()
    currentWalkSpeed = tonumber(WalkSpeedBox.Text) or currentWalkSpeed
    HatchEgg = tonumber(EggBox.Text) or HatchEgg
    warn("ÄÃ£ cáº­p nháº­t: Tá»‘c Ä‘á»™ = "..currentWalkSpeed.." Trá»©ng thá»© : "..HatchEgg)
    
    -- Ãp dá»¥ng ngay láº­p tá»©c náº¿u Ä‘ang á»Ÿ cháº¿ Ä‘á»™ hoáº¡t Ä‘á»™ng
    if currentMode == 2 and character and humanoid then
        humanoid.WalkSpeed = currentWalkSpeed
    end

local args = {HatchEgg + 7000000,1}
game:GetService("ReplicatedStorage"):WaitForChild("Tool"):WaitForChild("DrawUp"):WaitForChild("Msg"):WaitForChild("DrawHero"):InvokeServer(unpack(args))

end)

-- Káº¿t ná»‘i sá»± kiá»‡n nÃºt Reset/Cháº¿ Ä‘á»™
ResetButton.MouseButton1Click:Connect(function()
    currentMode = (currentMode % 2) + 1 -- LuÃ¢n phiÃªn 1-2
    updateModeDisplay()
                local args = {"isAutoOn", 0}
            ReplicatedStorage:WaitForChild("ServerMsg"):WaitForChild("Setting"):InvokeServer(unpack(args))    
    game.StarterGui:SetCore("SendNotification", {
        Title = "ÄÃƒ Äá»”I CHáº¾ Äá»˜ "..currentMode,
        Text = ResetButton.Text,
        Duration = 3
    })
    
    -- Náº¿u chuyá»ƒn sang cháº¿ Ä‘á»™ hoáº¡t Ä‘á»™ng, Ã¡p dá»¥ng speed ngay
    if currentMode == 2 and character and humanoid then
        humanoid.WalkSpeed = currentWalkSpeed
    elseif currentMode == 2 and character and humanoid then

    end
end)

-- Há»‡ thá»‘ng chÃ­nh
local function mainLoop()
    while true do
        task.wait(0.1)
        
        -- Kiá»ƒm tra vÃ  cáº­p nháº­t character
        if not character or not character.Parent then
            character = player.Character or player.CharacterAdded:Wait()
            humanoid = character:WaitForChild("Humanoid")
            humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        end
        
        -- Chá»‰ xá»­ lÃ½ khi á»Ÿ cháº¿ Ä‘á»™ hoáº¡t Ä‘á»™ng
        while currentMode == 2 do
            -- Ãp dá»¥ng tá»‘c Ä‘á»™ di chuyá»ƒn
	    local character = player.Character or player.CharacterAdded:Wait()
   	    local humanoid = character:WaitForChild("Humanoid")
   	    humanoid.WalkSpeed = currentWalkSpeed
            -- Kiá»ƒm tra Ä‘á»™ cao má»—i 3 giÃ¢y
            if time() - lastHeightCheck >= nextCheckInterval then
                local height = humanoidRootPart.Position.Y
                
                if fixnon == height then
                    warn("Lá»—i: NhÃ¢n váº­t á»Ÿ nguyÃªn Ä‘á»™ cao")
                    killCharacter()
                end
		if height >= 14000 then
                    warn("too high, u need jump")
		    humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                end

                nextCheckInterval = math.random(3, 9)
		fixnon = height
                lastHeightCheck = time()
            end
            
            -- Gá»­i yÃªu cáº§u server
            local args = {"isAutoOn", 1}
            ReplicatedStorage:WaitForChild("ServerMsg"):WaitForChild("Setting"):InvokeServer(unpack(args))
        end
    end
end

-- ThÃ´ng bÃ¡o khá»Ÿi Ä‘á»™ng
game.StarterGui:SetCore("SendNotification", {
    Title = "Há»† THá»NG KHá»I Äá»˜NG",
    Text = "âš”ï¸ â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ”",
    Duration = 5
})

-- Khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng
killCharacter() -- Reset ban Ä‘áº§u
updateModeDisplay() -- Cáº­p nháº­t giao diá»‡n láº§n Ä‘áº§u
task.spawn(mainLoop) -- Cháº¡y vÃ²ng láº·p chÃ­nh

